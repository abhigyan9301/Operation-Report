

function onAppReady() {
    if( navigator.splashscreen && navigator.splashscreen.hide ) {   // Cordova API detected
        navigator.splashscreen.hide() ;
    }
}
document.addEventListener("app.Ready", onAppReady, false) ;
// document.addEventListener("deviceready", onAppReady, false) ;
// document.addEventListener("onload", onAppReady, false) ;

// The app.Ready event shown above is generated by the init-dev.js file; it
// unifies a variety of common "ready" events. See the init-dev.js file for
// more details. You can use a different event to start your app, instead of
// this event. A few examples are shown in the sample code above. If you are
// using Cordova plugins you need to either use this app.Ready event or the
// standard Crordova deviceready event. Others will either not work or will
// work poorly.

// NOTE: change "dev.LOG" in "init-dev.js" to "true" to enable some console.log
// messages that can help you debug Cordova app initialization issues.


/////////// login val










$(function() {
    
    
                       
                var userName= localStorage.getItem("PMUsername");
                var userPass= localStorage.getItem("PMPassword");
    
     $.ajax({
                      type: "POST",
                      url: "https://cordovaprod.eu-gb.mybluemix.net/CRM_STATUS_REPORT.jsp",
                      data: ({User: userName,Pass: userPass}),
                      cache: false,
                      dataType: "text",
                      success: onSuccess
                    });
//    
     function onSuccess(data)
            {
////                $('#work-in-progress').fadeOut(0);
                var Data = $.parseJSON(data);
//                
                $.each(Data.retail_crm, function(i, f) {
                    
                    document.getElementById("store_visited").value = f.Stores_Visited;
                      document.getElementById("po_signed").value = f.PO_Signed;
                    document.getElementById("probable").value = f.Probable;
                    document.getElementById("not_interested").value = f.Not_Interested;
                    document.getElementById("no_feedback_yet").value = f.No_feedback_yet;
                     document.getElementById("Po_Signed_and_Machine_Installed").value = f.Po_Signed_and_Machine_Installed;
                    document.getElementById("stores_with_99rstreet").value = parseInt(f.PO_Signed)+parseInt(f.Po_Signed_and_Machine_Installed);

                    

     
       
 });
                
            }
});
    


 /*$(document).ready(function() {
//            $('#work-in-progress').fadeOut(0);
 
            //$("#callAjax").click(function() {
                var theName = $.trim($("#theName").val());
                var thePassword = $.trim($("#thePassword").val());
 
                if(theName.length > 0)
                {
                    $('#work-in-progress').fadeIn(0);
                    $.ajax({
                      type: "POST",
                      url: "https://cordovacrm.eu-gb.mybluemix.net/crm_login.jsp",
                      data: ({User: theName,Pass: thePassword}),
                      cache: false,
                      dataType: "text",
                      success: onSuccess
                    });
                }
            });
 
            $("#resultLog").ajaxError(function(event, request, settings, exception) {
              $("#resultLog").html("Error Calling: " + settings.url + "<br />HTTP Code: " + request.status);
            });
 
            function onSuccess(data)
            {
//                $('#work-in-progress').fadeOut(0);
                var Data = $.parseJSON(data);
                
                if(Data.success=='1')
                {
//                     var theName = $.trim($("#theName").val());
//                var thePassword = $.trim($("#thePassword").val());
//                    localStorage.setItem("PMUsername",theName);
//                    localStorage.setItem("PMPassword",thePassword);
                    window.location = 'home.html';
                     alert('Login Successful!');
                }
//                $("#resultLog").html("Result: " + Data.success);
                
                else if (Data.success =='0')
                {
                    document.getElementById("waiting").innerHTML="";
              alert('Wrong user name or password!');

                }
            }
 
        });
   


*/



///////////////// HOME PAGE OPERATION




$(document).on('pageinit', '#home', function(){      
//    var url = 'http://api.themoviedb.org/3/',
//        mode = 'search/movie?query=',
//        movieName = '&query='+encodeURI('Batman'),        
//        key = '&api_key=5fbddf6b517048e25bc3ac1bbeafb919';    
    var url = 'http://apiprod.mybluemix.net/OperationJSP/Retail_CRM_Address.jsp';
    
    $.ajax({
//        url: url + mode + key + movieName ,
        url: url,
        dataType: "json",
        async: true,
        success: function (result) {
             $('#work-in-progress').fadeOut(0);
            ajax.parseJSON(result);
             
           
        },
        error: function (request,error) {
            alert('Network error has occurred please try again!');
            
            document.getElementById("internet_access").innerHTML="No internet access";
        }
    });         
});

$(document).on('pagebeforeshow', '#headline', function(){      
    $('#movie-data').empty();
    $.each(movieInfo.result, function(i, row) {
        if(row.Store_id == movieInfo.id) {
            
            document.getElementById("store_id").value = row.Store_id;

        document.getElementById("store_name").value = row.NAME;
        document.getElementById("store_address").value = row.ADDRESS;

       
       
            $('#movie-data').listview('refresh');            
        }
    });    
});

$(document).on('vclick', '#movie-list li a', function(){  
    movieInfo.id = $(this).attr('data-id');
    $.mobile.changePage( "#headline", { transition: "slide", changeHash: false });
});

var movieInfo = {
    id : null,
    result : null
}

var ajax = {  
    parseJSON:function(result){  
        movieInfo.result = result.entries;
        $.each(result.entries, function(i, row) {
            console.log(JSON.stringify(row));
            $('#movie-list').append('<li><a href="" data-id="'  + row.Store_id + '">' +'<h3>' + row.NAME + '</h3><p2>' + row.ADDRESS + '</p2><p>'+row.Store_id + '</p></a></li>');
        });
        $('#movie-list').listview('refresh');
    }
}






//////////////////////////////////////////////////STORE VISITED//////////////////////////






////////////////////////////////////////////////////////////////// two................










//// OPERATION REPORT DATA UPLOAD ***********************

$(document).ready(function () {
    $("#uploadbutton").click(function () {
        var store_Id = $("#store_id").val();
        var store_nm = $("#store_name").val();
         var address = $("#store_address").val();
        var store_visit_date= $("#store_visit_date").val();
        var apk_version = $("#store_apk_version").val();
        var comments = $("#store_comment").val();
         var Issue = $("#store_issue").val();
        
       
         var USER_NAME = localStorage.getItem("PMUsername");



        $.ajax({
            type: "POST",
            /*url:"http://99app.mybluemix.net/myApi.jsp",*/
            
            url: "http://apiprod.mybluemix.net/OperationJSP/Operation_Report.jsp",

           /* url: "https://cordova.eu-gb.mybluemix.net?store_id="+filename + "&store_name=" + filename2+ "&ph_no="+filename3,*/
            data: {
                
                "store_Id" : store_Id,
                "store_nm" : store_nm, 
                "address" : address,
                 "store_visit_date" : store_visit_date,
                "apk_version" : apk_version, 
                "comments" : comments, 
                 "Issue" : Issue,
                "USER_NAME" : USER_NAME

            },
/*
            data: "store_id ="+ filename + "&store_name =" +filename2 + "&ph_no =" + filename3 ,
*/
            success: function (msg,String,jqXHR) {
                  window.location='home.html';

                
                $("#result").html(msg,String,jqXHR)
               alert("Data Uploaded: ");
                

            }
        });
    });
});




/////////////////////// reload


function Loading()
{
    document.getElementById("waiting").innerHTML = "Loading..."
}

/////////////////////////////////////////


////////////////// login validation 



///////////////////////////////// Date Picker







//////////////////////////////

/*
$(function() {
    
    
                       
           
    
     $.ajax({
                      type: "POST",
                      url: "https://cordovacrm.eu-gb.mybluemix.net/CRM_STATUS_REPORT.jsp",
                      cache: false,
                      dataType: "text",
                      success: onSuccess
                    });
//    
     function onSuccess(data)
            {
////                $('#work-in-progress').fadeOut(0);
                var Data = $.parseJSON(data);
//                
                $.each(Data.retail_crm, function(i, f) {
                    
                     document.getElementById("store_visited").value = f.Stores_Visited;
                      document.getElementById("po_signed").value = f.PO_Signed;
                    document.getElementById("probable").value = f.Probable;
                    document.getElementById("not_interested").value = f.Not_Interested;
                    document.getElementById("no_feedback_yet").value = f.No_feedback_yet;
     
       
 });
                
            }
});
    */



/*
$(function() {
    
var retail_crm = [];
var dmJSON = "https://cordovacrm.eu-gb.mybluemix.net/CRM_STATUS_REPORT.jsp";
$.getJSON(dmJSON, function(data) {
   $.each(data.retail_crm, function(i, f) {
       
                  document.getElementById("store_visited").value = f.Stores_Visited;
                      document.getElementById("po_signed").value = f.PO_Signed;
                    document.getElementById("probable").value = f.Probable;
                    document.getElementById("not_interested").value = f.Not_Interested;
                    document.getElementById("no_feedback_yet").value = f.No_feedback_yet;
     
 });
});
});*/


















/*



$(document).on('pageinit', '#issue', function(){      
//    var url = 'http://api.themoviedb.org/3/',
//        mode = 'search/movie?query=',
//        movieName = '&query='+encodeURI('Batman'),        
//        key = '&api_key=5fbddf6b517048e25bc3ac1bbeafb919';    
    var url = 'http://schedular.eu-gb.mybluemix.net/Store_Visited.jsp';
    
    $.ajax({
//        url: url + mode + key + movieName ,
        url: url,
        dataType: "json",
        async: true,
        success: function (result) {
             $('#work-in-progress').fadeOut(0);
            ajax.parseJSON(result);
             
           
        },
        error: function (request,error) {
            alert('Network error has occurred please try again!');
            
            document.getElementById("internet_access").innerHTML="No internet access";
        }
    });         
});

$(document).on('pagebeforeshow', '#headline5', function(){      
    $('#movie-data').empty();
    $.each(movieInfo.result, function(i, row) {
        if(row.Store_id == movieInfo.id) {
           
       
       
            $('#movie-data').listview('refresh');            
        }
    });    
});

$(document).on('vclick', '#movie-list2 li a', function(){  
    movieInfo.id = $(this).attr('data-id');
    $.mobile.changePage( "#headline2", { transition: "slide", changeHash: false });
});

var movieInfo = {
    id : null,
    result : null
}

var ajax = {  
    parseJSON:function(result){  
        movieInfo.result = result.entries;
        $.each(result.entries, function(i, row) {
            console.log(JSON.stringify(row));
            $('#movie-list2').append('<li><a href="" data-id="'  + row.Store_id + '">' +'<h3>' + row.STORE_NAME + '</h3><p2>' + row.STORE_ADDRESS + '</p2><p>'+row.STORE_VISIT_DATE + '</p></a></li>');
        });
        $('#movie-list2').listview('refresh');
    }
}

*/


