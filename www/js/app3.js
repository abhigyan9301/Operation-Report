

function onAppReady() {
    if( navigator.splashscreen && navigator.splashscreen.hide ) {   // Cordova API detected
        navigator.splashscreen.hide() ;
    }
}
document.addEventListener("app.Ready", onAppReady, false) ;
// document.addEventListener("deviceready", onAppReady, false) ;
// document.addEventListener("onload", onAppReady, false) ;

// The app.Ready event shown above is generated by the init-dev.js file; it
// unifies a variety of common "ready" events. See the init-dev.js file for
// more details. You can use a different event to start your app, instead of
// this event. A few examples are shown in the sample code above. If you are
// using Cordova plugins you need to either use this app.Ready event or the
// standard Crordova deviceready event. Others will either not work or will
// work poorly.

// NOTE: change "dev.LOG" in "init-dev.js" to "true" to enable some console.log
// messages that can help you debug Cordova app initialization issues.


/////////// login val










$(function() {
    
    
                       
                var userName= localStorage.getItem("PMUsername");
                var userPass= localStorage.getItem("PMPassword");
    
     $.ajax({
                      type: "POST",
                      url: "https://cordovaprod.eu-gb.mybluemix.net/CRM_STATUS_REPORT.jsp",
                      data: ({User: userName,Pass: userPass}),
                      cache: false,
                      dataType: "text",
                      success: onSuccess
                    });
//    
     function onSuccess(data)
            {
////                $('#work-in-progress').fadeOut(0);
                var Data = $.parseJSON(data);
//                
                $.each(Data.retail_crm, function(i, f) {
                    
                    document.getElementById("store_visited").value = f.Stores_Visited;
                      document.getElementById("po_signed").value = f.PO_Signed;
                    document.getElementById("probable").value = f.Probable;
                    document.getElementById("not_interested").value = f.Not_Interested;
                    document.getElementById("no_feedback_yet").value = f.No_feedback_yet;
                     document.getElementById("Po_Signed_and_Machine_Installed").value = f.Po_Signed_and_Machine_Installed;
                    document.getElementById("stores_with_99rstreet").value = parseInt(f.PO_Signed)+parseInt(f.Po_Signed_and_Machine_Installed);

                    

     
       
 });
                
            }
});
    





///////////////// HOME PAGE OPERATION




$(document).on('pageinit', '#home', function(){      
//    var url = 'http://api.themoviedb.org/3/',
//        mode = 'search/movie?query=',
//        movieName = '&query='+encodeURI('Batman'),        
//        key = '&api_key=5fbddf6b517048e25bc3ac1bbeafb919';    
    var url = 'http://apiprod.mybluemix.net/OperationJSP/Retail_Store_Maint.jsp';
    
    $.ajax({
//        url: url + mode + key + movieName ,
        url: url,
        dataType: "json",
        async: true,
        success: function (result) {
             $('#work-in-progress').fadeOut(0);
            ajax.parseJSON(result);
             
           
        },
        error: function (request,error) {
            alert('Network error has occurred please try again!');
            
            document.getElementById("internet_access").innerHTML="No internet access";
        }
    });         
});

$(document).on('pagebeforeshow', '#headline', function(){      
    $('#movie-data').empty();
    $.each(movieInfo.result, function(i, row) {
        if(row.TICKET_ID == movieInfo.id) {
            
            document.getElementById("store_id").value = row.STORE_ID;

        document.getElementById("store_name").value = row.STORE_NAME;
        document.getElementById("store_address").value = row.ADDRESS;
                    document.getElementById("store_issue").value = row.SUBJECT_DESC;
                    document.getElementById("store_ticket_id").value = row.TICKET_ID;



       
       
            $('#movie-data').listview('refresh');            
        }
    });    
});

$(document).on('vclick', '#movie-list li a', function(){  
    movieInfo.id = $(this).attr('data-id');
    $.mobile.changePage( "#headline", { transition: "slide", changeHash: false });
});

var movieInfo = {
    id : null,
    result : null
}

var ajax = {  
    parseJSON:function(result){  
        movieInfo.result = result.entries;
        $.each(result.entries, function(i, row) {
            console.log(JSON.stringify(row));
           $('#movie-list').append('<li><a href="" data-id="'+ row.TICKET_ID + '">' +'<h3>' +'Store ID  : '+ row.STORE_ID + '</h3><p9>' +'Store Name : '+ row.STORE_NAME + '</p9> <p2><br>Store Issue : '+ row.SUBJECT_DESC + '</p2><p2><br>Address : '+ row.ADDRESS +'<p>' + 'Status : '+ row.STATUS +'<br></p2><p>' +'Ticket ID : '+ row.TICKET_ID + '</p></a></li>');
            
             });
        $('#movie-list').listview('refresh');
    }
}






//////////////////////////////////////////////////STORE VISITED//////////////////////////






////////////////////////////////////////////////////////////////// two................










//// OPERATION REPORT DATA UPLOAD ***********************

$(document).ready(function () {
    $("#uploadbutton").click(function () {
        var store_Id = $("#store_id").val();
        var store_nm = $("#store_name").val();
         var address = $("#store_address").val();
        var store_visit_date= $("#store_visit_date").val();
        var apk_version = $("#store_apk_version").val();
        var comments = $("#store_comment").val();
         var Issue = $("#store_issue").val();
       var ticket_Id = $("#store_ticket_id").val();
       var SUPPORT_TICKET_STATUS = $("#store_status").val();


        
       
         var USER_NAME = localStorage.getItem("PMUsername");



        $.ajax({
            type: "POST",
            
            url: "http://apiprod.mybluemix.net/OperationJSP/Retail_OP_IN_MAINT_UP.jsp",

           /* url: "https://cordova.eu-gb.mybluemix.net?store_id="+filename + "&store_name=" + filename2+ "&ph_no="+filename3,*/
            data: {
                
                "store_Id" : store_Id,
                "store_nm" : store_nm, 
                "address" : address,
                 "store_visit_date" : store_visit_date,
                "apk_version" : apk_version, 
                "comments" : comments, 
                 "Issue" : Issue,
                "ticket_Id" : ticket_Id,
                "SUPPORT_TICKET_STATUS" : SUPPORT_TICKET_STATUS,
                "USER_NAME" : USER_NAME

            },
/*
            data: "store_id ="+ filename + "&store_name =" +filename2 + "&ph_no =" + filename3 ,
*/
            success: function (msg,String,jqXHR) {
                  window.location='storeissue.html';

                
                $("#result").html(msg,String,jqXHR)
               alert("Data Uploaded: ");
                

            }
        });
    });
});




/////////////////////// reload


function Loading()
{
    document.getElementById("waiting").innerHTML = "Loading..."
}





















